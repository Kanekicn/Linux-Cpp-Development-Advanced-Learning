# 搞定SQL系列(12) 数据表的范式，你知道么

## 12.1 数据库的设计范式

范式：在设计数据库模型的时候，对关系内部各个属性之间的联系的合理化程度进行定义，使得其有不同等级的规范要求，称为范式。

关系型数据库有6种范式：1NF、2NF、3NF、BCNF（巴斯-科德范式）、4NF和5NF（完美范式）。数据库范式越高，其冗余度越低。

</br>

## 12.2 数据表的键

为更清晰的表达下列各键的含义，示例：NBA球员表和球队表。球员包含球员编号、姓名、身份证号、年龄和球队编号。球队包含球队编号、主教练和球队所在地。

- 超键：唯一标识元祖的属性集
  - (球员编号， 姓名)
  - (身份证号，姓名)
- 候选键：不包含多余属性的超键，即唯一标识元组的属性
  - (球员编号)
  - (身份证号)
- 主键：用户可以从候选键中选取一个作为主键
  - (球员编号)
  - (身份证号)
- 外键：其他数据表中的主键
  - (球队编号)
- 主属性：包含任一候选键中的属性
  - (球员编号)
  - (身份证号)
- 非主属性：不包含任一候选键中的属性
  - (姓名)
  - (年龄)

</br>

## 12.3 1NF、2NF、3NF

1NF：指数据库表中的任何属性都是原子的，不可再分。即对于字段X，不可分为X-1和字段X-2.

2NF：指数据表中的非主属性都和所有候选键有**完全依赖**关系，即在1NF基础上，消除对非主属性对键的部分依赖。

示例 - 不满足2NF：player_game表中有球员编号、姓名、年龄、比赛编号、比赛时间和比赛场地。可以通过候选键决定如下关系：

(球员编号， 比赛编号) ---> (姓名，年龄，比赛时间，比赛场地，得分)

因为对于非主属性，还满足（部分依赖）：

(球员编号) ---> (姓名，年龄)

(比赛编号) ---> (比赛时间，比赛场地)

将该表分为三张表：player(球员编号，姓名，年龄)，game( 比赛编号，比赛时间，比赛场地)，player_game(球员编号，比赛编号，得分)

3NF：在满足2NF同时，对任何非主属性都**不传递依赖**于候选键，即在2NF基础上，消除非主属性对键的传递依赖。即不能存在非主属性A依赖于非主属性B，非主属性B依赖于候选键。

<img src="https://static001.geekbang.org/resource/image/42/33/4286e4c955589ab7145ee36ab135b933.jpg" alt="img" style="zoom:80%;" />

示例- 满足3NF：球员表属性包括球员编号、姓名和球队名称；球队表属性包括球队名称、球队主教练。

## 小结

![img](https://static001.geekbang.org/resource/image/e7/11/e775113e733020a7810196afd4f58711.jpg)